import React, { useState, useEffect } from 'react'


type Props = {
    parks: server[];
    // setFilteredParks: (parks: serv[]) => {};
    setFilteredParks: any;
}

function getCities(parks: ParkType[]): string[] {
    let cities: string[] = [];
    for (const p of parks) {
        if (!cities.includes(p.city)) {
            cities.push(p.city)
        }
    }
    return cities
}

const FilterHeader = (props: Props) => {
    const [onlylAvailable, setOnlyAvailble] = useState<boolean>(false);
    const [city, setCity] = useState<string>("")

    useEffect(() => {
        let filteredParks = props.parks;
        if (onlylAvailable)
            filteredParks = filteredParks.filter((p) => { return !p.isOccupied });
        if (city !== "") {
            filteredParks = filteredParks.filter((p) => { return p.city === city });
        }

        props.setFilteredParks(filteredParks);
    }, [onlylAvailable, city])


    const handleOnlyAvailble = () => {
        setOnlyAvailble((prev) => !prev);
    }

    return (
        <div>
            <label> Show only available</label>
            <input type='checkbox' checked={onlylAvailable} onChange={handleOnlyAvailble} />
            <br />
            <label> Filter by city</label>
            <select name="cities" id="cars" onChange={(e) => { setCity(e.target.value) }}>
                <option value={""} onChange={()=>{setCity("")}}> ALL </option>
                {getCities(props.parks).map((c) => { return <option value={c}> {c} </option> })}
            </select>
        </div>
    )
}

export default FilterHeader